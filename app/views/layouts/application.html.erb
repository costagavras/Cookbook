<!DOCTYPE html>
<html>
  <head>
    <title>Cookbook</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <link href="https://fonts.googleapis.com/css?family=Ruluko" rel="stylesheet">

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>

    <% %w(192 384).each do |s| %>
      <%= favicon_link_tag "android-chrome-#{s}x#{s}.png", rel: 'android-chrome-icon', type: 'image/png', sizes: "#{s}x#{s}" %>
    <% end %>

      <%= favicon_link_tag "apple-touch-icon.png", rel: 'apple-touch-icon', type: 'image/png' %>

    <% %w(16 32).each do |s| %>
      <%= favicon_link_tag "favicon-#{s}x#{s}.png", rel: 'icon', type: 'image/png', sizes: "#{s}x#{s}" %>
    <% end %>

  </head>

  <body>

    <div class="lang_switch">
      <%if !request.path_info.include?("search") %>
          <span id="switch_lang"><%=link_to("ðŸ‡¨ðŸ‡¦", {:locale=>"en"}, :id => "en")%>  <%=link_to("ðŸ‡®ðŸ‡¹", {:locale=>"it"}, :id => "it")%>   <%=link_to("ðŸ‡«ðŸ‡·", {:locale=>"fr"}, :id => "fr")%>  <%=link_to("ðŸ‡·ðŸ‡º", {:locale=>"ru"}, :id => "ru") %>
          </span>
      <%end%>
    </div>

    <div class="navigation_bar">
      <div class="nav_1">
        <div class="top_top">
          <% if current_user%>
            <h2 class = "logo_text"><%= link_to "#{current_user.name}'s", user_path(current_user) %></h2>
          <% else %>
            <h2 class = "logo_text"><%= "Your" %></h2>
          <% end %>
          <%= link_to (image_tag 'android-chrome-384x384.png', :class => "logo_img", :width => "250", :length =>"100"), root_path %>
        </div>
        <div class="top_centre">
          <p><%="The place where your recipes are at home"%></p>
        </div>
        <div class="top_bottom">
          <ul class="user_options">
            <% if current_user%>
              <div class="logged_in">
                <% if !request.path_info.include?("search") %>
                  <li><%= link_to "Sign out", session_path("supercazzola"), :method => :delete %></li>
                <% end %>
              </div>
            <% else %>
              <div class="logged_out">
                <% if !request.path_info.include?("search") %>
                  <li class="sign_in"><%= link_to "Sign up", new_user_path, :class => "signin_button" %></li>
                  <li class="log_in"><%= link_to "Log in", new_session_path, :class => "login_button" %></li>
                <% end %>
              </div>
            <% end %>
          </ul>
        </div>
      </div>
      <div class="nav_2">
          <div class="user_options">
            <% if current_user %>
              <div class="search_bar">
                <%= form_tag(recipe_search_path, {:id => 'search_form'}) do %>
                <%= text_field_tag :recipe, params[:recipe], :class => "search_field", :placeholder => 'Search for recipes!' %><%= submit_tag "search", name: nil, :class => "search_button" %>
                <% end %>
              </div>
            <% end %>
          </div>
          <div class="user_options">
            <% if current_user && request.path_info.include?("recipes/") && !request.path_info.include?("new")  %>
              <span><%= link_to 'My recipes', recipes_path%></span>
              <span><%= link_to 'New recipe', new_recipe_path%></span>
              <span><%= link_to('Edit recipe', edit_recipe_path, :id => "edit_recipe_button") %></span>
              <span><%= link_to('Delete recipe', recipe_path(@recipe), method: :delete, data: {confirm: "Are you sure you want to delete this recipe?"}, :id => "delete_recipe_button") %></span>
            <% elsif current_user %>
              <span><%= link_to 'My recipes', recipes_path%></span>
              <span><%= link_to 'New recipe', new_recipe_path%></span>
            <% end %>
          </div>
      </div>
      <div class="flash_message">
        <% flash.each do |key, message| %>
        <div class="flash-<%= key %>"><span class="error_message"><%= message %></span></div>
        <% end %>
      </div>
    </div>

    <main>
    <hr>
     <%= render 'sessions/form' %>
     <%= render 'users/form' %>
     <%= yield %>
    <hr>
    <div class="most_popular">
      <% if current_user %>
        <h2 class="most_viewed">Most popular</h2>
        <div class="most_viewed_block">
          <% most_viewed_recipes.each do |recipe|%>
            <div class = "index_recipe">
                <h3><%=link_to("#{recipe.name}", recipe_path(recipe))%></h3>
                <h3><span><%=recipe.visits%>&nbsp;&nbsp;views</span></h3>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
    </main>
    <footer>
      <div class="info_nav">
        <ul class="info_list">
          <p><%=t("made_by")%></p>
          <li><%= link_to("About this project & me", about_path) %></li>
        </ul>
      </div>
    </footer>
  </body>
</html>
